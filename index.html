<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Muted Video Test</title>
</head>
<body>
  <div id="player-container-e94a09f7-132a-4dd6-aa9f-f80cd87883f3"> </div>
    <script type="text/javascript">
      (function () {
        function createScript(src) {
          var s = document.createElement('script');
          s.setAttribute('src', src);
          s.setAttribute('id', 'public-player-script');
          document.body.appendChild(s);
          return s;
        }

        function tryMuteVideo(retries = 10) {
          const tryFind = () => {
            const video = document.querySelector('#player-container-e94a09f7-132a-4dd6-aa9f-f80cd87883f3 video');
            if (video) {
              video.muted = true;
              video.volume = 0;
              video.setAttribute('muted', '');
              console.log('✅ Video muted');
            } else if (retries > 0) {
              setTimeout(() => tryMuteVideo(retries - 1), 1000);
            } else {
              console.warn('⚠️ Не удалось найти <video>');
            }
          };
          tryFind();
        }

        function createPublicPlayer() {
          publicPlayer.create({"element":"player-container-e94a09f7-132a-4dd6-aa9f-f80cd87883f3","guid":"e94a09f7-132a-4dd6-aa9f-f80cd87883f3","statisticsPath":"https://test-mvsr.mos.ru/admin/video/statistics/","kms":false,"autoPlay":false});
          tryMuteVideo();
        }

        var scriptElem = document.getElementById('public-player-script');

        if (window['publicPlayer']) {
          createPublicPlayer();
        } else if (scriptElem) {
          scriptElem.addEventListener('load', createPublicPlayer);
        } else {
          createScript('https://mvsr.mos.ru/player/assets/private-cameras/public-player-deti.js').addEventListener('load', createPublicPlayer);
        }
      })();
    </script>
</body>
</html>
